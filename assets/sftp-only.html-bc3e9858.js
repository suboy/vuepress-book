import{_ as t,o as s,c as r,f as o}from"./app-470db377.js";const e={},p=o("<p>有时候ssh到远程主机，只想传文件不会用到shell，就可以创建一个sftp only的账号</p><ol><li><p>新建用户sftp, useradd -d /home/sftp -s /sbin/nologin sftp</p></li><li><p>home/sftp目录要是root:root 755<br> 本身sftp没有权限<br> 在home目录下建立sftp的数据目录data用于上传数据<br> mkdir /home/sftp<br> mkdir /home/sftp/.ssh</p></li><li><p>生成rsa密钥对<br> 其中id_rsa是私钥, id_rsa.pub是公钥, 公钥放服务器, 私钥放ssh客户端<br> ssh-keygen -t rsa<br> cat id_rsa.pub &gt;&gt; authorized_keys<br> .ssh要sftp用户可读</p></li><li><p>/etc/ssh/sshd_config追加:<br> Match Group sftp // 对于sftp组的用户的特别配置<br> X11Forwarding no // 禁止x11转发<br> AllowTcpForwarding no //禁止tcp转发<br> ForceCommand internal-sftp //只能用sftp命令<br> ChrootDirectory %h //所有活动限制在home目录<br> Match all</p></li><li><p>为了避免权限问题, sftp home的目录可mount到实际目录<br> mount --bind /var/cdn cdn<br> mount --bind /var/html html</p></li></ol>",2),n=[p];function l(i,a){return s(),r("div",null,n)}const h=t(e,[["render",l],["__file","sftp-only.html.vue"]]);export{h as default};
